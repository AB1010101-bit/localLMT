<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LabTool</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>LabTool</h1>
            <div id="statsBar" class="stats-bar"></div>
            <!-- Emergency Contacts Bar -->
            <div id="emergencyBar" class="emergency-bar">
                <div class="emergency-contacts">
                    <button class="emergency-btn poison-control" onclick="showEmergencyContact('poison')">
                        ‚ò†Ô∏è Poison Control: 1-800-222-1222
                    </button>
                    <button class="emergency-btn fire-dept" onclick="showEmergencyContact('fire')">
                        üö® Fire/EMS: 911
                    </button>
                    <button class="emergency-btn hazmat" onclick="showEmergencyContact('hazmat')">
                        ‚ö†Ô∏è Hazmat Response: 1-800-424-9300
                    </button>
                    <button class="emergency-btn" onclick="showSafetyProtocols()">
                        üõ°Ô∏è Safety Protocols
                    </button>
                </div>
            </div>
            <div class="header-controls">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search chemicals and apparatus...">
                    <button id="searchBtn">Search</button>
                </div>
                <div class="admin-section">
                    <div id="adminLoginSection">
                        <button id="adminLoginBtn" class="admin-btn">Admin Login</button>
                    </div>
                    <div id="adminLoggedSection" style="display: none;">
                        <span class="admin-status">Admin Mode</span>
                        <button id="adminLogoutBtn" class="admin-btn logout">Logout</button>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div class="tabs">
                <button class="tab-button active" onclick="openTab(event, 'chemicals')">Chemicals</button>
                <button class="tab-button" onclick="openTab(event, 'apparatus')">Apparatus</button>
            </div>

            <div id="chemicals" class="tab-content active">
                <h2>Chemicals Inventory</h2>
                <div id="adminControlsChemicals" class="admin-controls" style="display: none;">
                    <div class="admin-actions">
                        <button onclick="labSystem.showAddChemicalForm()" class="admin-action-btn btn-add">
                            ‚ûï Add Chemical
                        </button>
                        <button onclick="updateChemicalDescriptions()" class="admin-action-btn btn-update-descriptions">
                            üìö Update Descriptions
                        </button>
                        <button onclick="addEssentialChemicals()" class="admin-action-btn btn-add-essentials">
                            ‚≠ê Add Essentials
                        </button>
                        <button onclick="labSystem.forceReloadMShelfChemicals()" class="admin-action-btn btn-reload-mshelves" style="background-color: #e74c3c;">
                            üß™ Force Reload M-Shelves
                        </button>
                        <button onclick="showIncidentReports()" class="admin-action-btn btn-incident-reports" style="background-color: #f39c12;">
                            üìã View Incident Reports
                        </button>
                        <button onclick="showSafetyDashboard()" class="admin-action-btn btn-safety-dashboard" style="background-color: #8e44ad;">
                            üõ°Ô∏è Safety Dashboard
                        </button>
                        <button onclick="runChemicalDiagnostic()" class="admin-action-btn btn-diagnostic" style="background-color: #17a2b8;">
                            üîç Diagnostic Check
                        </button>
                    </div>
                </div>
                <div class="add-item-section" style="display: none;" id="chemicalFormSection">
                    <h3>Add New Chemical</h3>
                    <form id="chemicalForm">
                        <input type="text" id="chemicalName" placeholder="Chemical Name" required>
                        <input type="text" id="chemicalFormula" placeholder="Formula (e.g., H2SO4)">
                        <input type="number" id="chemicalQuantity" placeholder="Quantity" required>
                        <input type="text" id="chemicalUnit" placeholder="Unit (e.g., ml, g)">
                        <input type="text" id="chemicalLocation" placeholder="Storage Location">
                        <input type="date" id="chemicalExpiry" placeholder="Expiry Date">
                        <select id="chemicalHazard">
                            <option value="">Select Hazard Level</option>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                            <option value="extreme">Extreme</option>
                        </select>
                        <textarea id="chemicalNotes" placeholder="Additional Notes (optional)"></textarea>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit">Add Chemical</button>
                            <button type="button" onclick="labSystem.cancelEdit()" style="background: #666; padding: 12px 30px; color: #e0e0e0; border: 1px solid #777; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 500;">Cancel</button>
                        </div>
                    </form>
                </div>
                <div class="items-list" id="chemicalsList">
                    <!-- Chemical items will be displayed here -->
                </div>
            </div>

            <div id="apparatus" class="tab-content">
                <h2>Apparatus Inventory</h2>
                <div id="adminControlsApparatus" class="admin-controls" style="display: none;">
                    <div class="admin-actions">
                        <button onclick="labSystem.showAddApparatusForm()" class="admin-action-btn btn-add">
                            ‚ûï Add Apparatus
                        </button>
                    </div>
                </div>
                <div class="add-item-section" style="display: none;" id="apparatusFormSection">
                    <h3>Add New Apparatus</h3>
                    <form id="apparatusForm">
                        <input type="text" id="apparatusName" placeholder="Apparatus Name" required>
                        <input type="text" id="apparatusType" placeholder="Type (e.g., Glassware, Electronic)">
                        <input type="number" id="apparatusQuantity" placeholder="Quantity Available" required>
                        <input type="text" id="apparatusLocation" placeholder="Storage Location">
                        <input type="text" id="apparatusCondition" placeholder="Condition">
                        <input type="date" id="apparatusLastMaintenance" placeholder="Last Maintenance">
                        <textarea id="apparatusNotes" placeholder="Additional Notes"></textarea>
                        <div style="display: flex; gap: 10px;">
                            <button type="submit">Add Apparatus</button>
                            <button type="button" onclick="labSystem.cancelEdit()" style="background: #666; padding: 12px 30px; color: #e0e0e0; border: 1px solid #777; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 500;">Cancel</button>
                        </div>
                    </form>
                </div>
                <div class="items-list" id="apparatusList">
                    <!-- Apparatus items will be displayed here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Safety Alert Modal -->
    <div id="safetyModal" class="modal">
        <div class="modal-content safety-modal">
            <span class="close" onclick="closeSafetyModal()">&times;</span>
            <div class="safety-header">
                <h2>‚ö†Ô∏è CHEMICAL SAFETY ALERT</h2>
            </div>
            <div id="safetyContent" class="safety-content">
                <!-- Dynamic safety content will be inserted here -->
            </div>
            <div class="safety-acknowledgment">
                <label>
                    <input type="checkbox" id="safetyAcknowledge"> 
                    I acknowledge that I have read and understand the safety warnings for this chemical
                </label>
                <button id="safetyProceed" class="safety-btn" disabled onclick="proceedWithChemical()">
                    Proceed with Caution
                </button>
            </div>
        </div>
    </div>

    <!-- Emergency Contact Modal -->
    <div id="emergencyModal" class="modal">
        <div class="modal-content emergency-modal">
            <span class="close" onclick="closeEmergencyModal()">&times;</span>
            <div id="emergencyContent" class="emergency-content">
                <!-- Dynamic emergency content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Incident Report Modal -->
    <div id="incidentModal" class="modal">
        <div class="modal-content incident-modal">
            <span class="close" onclick="closeIncidentModal()">&times;</span>
            <h2>üö® Chemical Incident Report</h2>
            <form id="incidentForm">
                <div class="form-group">
                    <label>Incident Type:</label>
                    <select id="incidentType" required>
                        <option value="">Select incident type</option>
                        <option value="spill">Chemical Spill</option>
                        <option value="exposure">Chemical Exposure</option>
                        <option value="fire">Fire/Explosion</option>
                        <option value="reaction">Unexpected Reaction</option>
                        <option value="equipment">Equipment Failure</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Chemical(s) Involved:</label>
                    <input type="text" id="incidentChemicals" placeholder="List chemicals involved" required>
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="incidentDescription" placeholder="Describe what happened" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>Injuries/Exposure:</label>
                    <textarea id="incidentInjuries" placeholder="Any injuries or exposures" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>Actions Taken:</label>
                    <textarea id="incidentActions" placeholder="Emergency actions taken" rows="3" required></textarea>
                </div>
                <button type="submit" class="incident-submit-btn">Submit Incident Report</button>
            </form>
        </div>
    </div>

    <!-- Incident Reports Modal -->
    <div id="incidentReportsModal" class="modal">
        <div class="modal-content incident-modal">
            <span class="close" onclick="closeIncidentReportsModal()">&times;</span>
            <h2>üìã Chemical Incident Reports</h2>
            <div id="incidentReportsList" class="incident-reports-list">
                <!-- Incident reports will be displayed here -->
            </div>
        </div>
    </div>

    <!-- Safety Dashboard Modal -->
    <div id="safetyDashboardModal" class="modal">
        <div class="modal-content safety-modal">
            <span class="close" onclick="closeSafetyDashboardModal()">&times;</span>
            <h2>üõ°Ô∏è Laboratory Safety Dashboard</h2>
            <div id="safetyDashboardContent" class="safety-dashboard-content">
                <!-- Safety dashboard content will be displayed here -->
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="safety-features.js"></script>
    <script src="diagnostic.js"></script>
</body>
</html>